'use strict';

const Promise = require('bluebird');
const loggingFactory = require('winrow-logger');
const requestId = require('../supports/requestId');

function handleError(err, res) {
  loggingFactory.error(`function handleError has error`,
    { requestId: `${requestId}` });

  if (err instanceof Error) {
    loggingFactory.warn(`error has type Error`, {
      requestId: `${requestId}`,
    });
    res.status(500).send({
      name: err.name,
      message: err.message
    })
    return Promise.reject(err);
  } else {
    loggingFactory.warn(`error has not type Error`, { requestId: `${requestId}` });
    const { name, message, statusCode } = err;
    res.status(statusCode).send({
      name: name,
      message: message
    })
    return Promise.reject(JSON.stringify(err));
  }
};

module.exports = handleError;
